-- Generated by LaTeX DogWagger Version 4.0.5 from file <small_time_400.tex>
-- Date: [2026-1-31 14:42:15] 
-- Do NOT edit this file. Edit the LaTeX source!!

-- - <Section 1> - 
-- The main SQL file is smalltime.sql

 SET default_storage_engine = INNODB; -- trust nobody

 SET @GLOBALS_UNLIMITED = 999999999999999999;


-- - <Section 2> - 
SELECT Now() `Starting`,"SKEYS" `Table`;

CREATE TABLE SKEYS (
  kName varchar(32)
    ,constraint bad_key_pk primary key(kName)
  ,kValue BIGINT
  ,klock BIGINT
  ,kuser integer
  )CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;

-- - <Section 3> - 
SET @MIN_NORMAL_KEY = 2000;

INSERT INTO SKEYS (kName, kValue, klock) VALUES 
  ('SOURCES',            @MIN_NORMAL_KEY+100, 0),
  ('PLACES',             @MIN_NORMAL_KEY+1000, 0),
  ('PEOPLE',             @MIN_NORMAL_KEY+40000, 0), 

  ('Institutions',       @MIN_NORMAL_KEY+2000, 0),
  ('Sourcecripts',       @MIN_NORMAL_KEY+3000, 0)
  ;

-- - <Section 4> - 
SET @MIN_TEST_KEY = 100;
SET @MIN_NORMAL_KEY = 2000;

INSERT INTO SKEYS (kName, kValue, klock) VALUES 
  ('timely', @MIN_TEST_KEY-1, 0),
  ('relationships', @MIN_NORMAL_KEY, 0)
  ;

-- - <Section 5> - 
CREATE FUNCTION GT (b BIGINT)
  RETURNS CHAR(26) DETERMINISTIC
  RETURN FROM_UNIXTIME( b/1000000 - 210866760000 );

CREATE FUNCTION JD (s VARCHAR(26))
RETURNS BIGINT DETERMINISTIC
RETURN 1000000*(86400*(1721059+TO_DAYS(s))+TIME_TO_SEC(s));

-- - <Section 6> - 
SET @SYSOP = 2000;

SELECT Now() `Starting`,"REASONS" `Table`;

CREATE TABLE REASONS
( rsn integer
    ,constraint reason_pk PRIMARY KEY(rsn)
  ,description varchar(128)
  ,shortname varchar(32)
  ,t_amended BIGINT 
  ,reason int
  ,p_amended BIGINT 
  ,amender integer   
--  ,constraint bad_reason_amender foreign key(amender)
--     references PEOPLE(person)
  ,srcID BIGINT
  ,src BIGINT
--    ,constraint bad_reason_src foreign key(src)
--       references SOURCES(src)
  ,ver integer default 0
  ,chk int
) CHARACTER SET=utf8mb4 
  COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE REASONS;

-- - <Section 7> - 
INSERT INTO REASONS (
  rsn, description, t_amended, reason, 
  p_amended, amender, src, chk, ver)
VALUES 
  (0,  'unknown',   0, 0, 0, @SYSOP, 2001, 0, 0),
  (-1, 'deleted',   0, 0, 0, @SYSOP, 2001, 0, 0),
  ( 1, 'omitted',   0, 0, 0, @SYSOP, 2001, 0, 0),
  ( 2, 'given',     0, 0, 0, @SYSOP, 2001, 0, 0),
  ( 3, 'deferred',  0, 0, 0, @SYSOP, 2001, 0, 0),
  (10, 'abandoned', 0, 0, 0, @SYSOP, 2001, 0, 0)
;

-- - <Section 8> - 
SELECT Now() `Sourcescripts`,"" `Table`;

CREATE TABLE Sourcescripts
( sourcescript BIGINT
  ,constraint bad_sourcescript_pk PRIMARY KEY(sourcescript)
  ,description varchar(64)
  ,version integer
  ,amender integer
--  ,constraint bad_sourcescript_amender foreign key(amender)
--    references PEOPLE(person)
  ,t_amended BIGINT 
  ,reason int
  ,p_amended BIGINT 

  ,src BIGINT
  ,srcID BIGINT
  ,ver integer default 0 -- version of this row
  ,chk int
)CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE Sourcescripts;

-- - <Section 9> - 
-- SET @SYSOP = 2000;

INSERT INTO Sourcescripts(sourcescript, description, version, amender, 
   src, chk)
 VALUES(0, 'none', 0, @SYSOP, 2001, 0);

-- - <Section 10> - 
SELECT Now() `Starting`,"SOURCES" `Table`;

CREATE TABLE SOURCES
( src BIGINT
  ,constraint bad_src_pk PRIMARY KEY(src)
  ,master varchar(128)
  ,nature integer
  ,institution integer
--  ,constraint bad_source_institution foreign key(institution)
--     references Institutions(institution)
  ,script BIGINT
  ,constraint bad_source_script foreign key(script)
     references Sourcescripts(sourcescript)
  ,amender int 
--  ,constraint bad_source_amender foreign key(amender)
--     references PEOPLE(person)
  ,t_amended BIGINT 
  ,reason int
  ,p_amended BIGINT 

  ,ssource BIGINT  -- check need for this field [explore]
  ,chk int

  ,ver integer default 0  -- version
)CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;

-- - <Section 11> - 
ALTER TABLE SOURCES ADD CONSTRAINT src_reflex foreign key(ssource)
  references SOURCES(src);

-- - <Section 12> - 
INSERT INTO SOURCES
 (src, master, institution, script, amender, 
  t_amended, reason, p_amended, ssource, chk)
VALUES
 (2001, 'internal generation', 0, 0, @SYSOP, 0, 0, 0, 2001, 0),
 (0, NULL, 0, 0, @SYSOP, NULL, NULL, 0, 2001, NULL); 

-- we can also amend REASONS: 
ALTER TABLE REASONS ADD CONSTRAINT bad_reason_src foreign key(src)
   references SOURCES(src); 

-- - <Section 13> - 
INSERT INTO SOURCES
 (src, master, institution, script, amender, t_amended, reason, 
  p_amended, ssource, chk)
VALUES
 (2005, 'TZ database', 0, 0, @SYSOP, 0, 0, 0, 2001, 0);

-- - <Section 14> - 
SELECT Now() `Starting`,"PEOPLE" `Table`;

CREATE TABLE PEOPLE
( person integer
    ,constraint person_pk PRIMARY KEY(person)
  ,t_amended BIGINT 
  ,reason int
  ,p_amended BIGINT 
  ,amender int 
  ,t_born BIGINT 
  ,t_born_P int
  ,p_born BIGINT
  ,t_died BIGINT
  ,t_died_P int
  ,p_died BIGINT
  ,flags BIGINT
  ,srcID BIGINT
  ,src BIGINT
    ,constraint src_people foreign key(src)
       references SOURCES(src)
  ,ver integer default 0
  ,chk int
)CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;

-- - <Section 15> - 
-- insert reference to system operator, code 2000. 
INSERT INTO PEOPLE
  (person, t_amended, p_amended, amender, t_born, p_born, src, chk, ver)
VALUES
  (@SYSOP,   0,         0,         @SYSOP,    0,      0,      2001,  0,    0);
-- we really should insert valid times and check value here. [fix me]

INSERT INTO PEOPLE
  (person, t_amended, p_amended, amender, t_born, p_born, src, chk, ver)
VALUES
  (0,   0,  0,   @SYSOP,  0,  0,  2001, 0,  0); -- "nobody"

-- - <Section 16> - 
ALTER TABLE PEOPLE ADD CONSTRAINT bad_people_amender foreign key(amender)
  references PEOPLE(person);

ALTER TABLE Sourcescripts ADD CONSTRAINT bad_sourcescript_amender foreign key(amender)
  references PEOPLE(person);

ALTER TABLE SOURCES ADD CONSTRAINT bad_source_amender foreign key(amender)
  references PEOPLE(person);

-- for REASONS too:
ALTER TABLE REASONS ADD CONSTRAINT bad_reason_amender foreign key(amender)
  references PEOPLE(person); 

-- - <Section 17> - 
SELECT Now() `Starting`,"PLACES" `Table`;

CREATE TABLE PLACES
( place BIGINT
    ,constraint place_pk PRIMARY KEY (place)
  ,description varchar(128)
  ,shortname varchar(32)
  ,amender int 
  ,constraint bad_place_amender foreign key(amender)
      references PEOPLE(person)
  ,srcID BIGINT
  ,src BIGINT
    ,constraint src_place foreign key(src)
       references SOURCES(src)
  ,t_amended BIGINT 
  ,reason int
  ,p_amended BIGINT 
    -- here have relevant geospatial coordinates, with precision:
  ,east integer
  ,north integer
  ,elevation integer
  ,east_P integer -- precision
  ,north_P integer 
  ,elevation_P integer
  ,ver integer default 0
  ,chk int
)CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE PLACES;

-- - <Section 18> - 
INSERT INTO PLACES (place, description, 
  p_amended, t_amended, reason, amender, src, chk)
  VALUES (0, 'nowhere', 
  0, 0, 0, @SYSOP, 2001, 0);

-- - <Section 19> - 
ALTER TABLE PLACES ADD CONSTRAINT bad_place_place foreign key(p_amended)
  references PLACES(place);

-- - <Section 20> - 
 insert into PLACES (place, description, amender, p_amended, src, east, north, reason) 
  values (1, 'UTC', @SYSOP, 0, 0, 0, 0, 0);

-- - <Section 21> - 
INSERT INTO PLACES (place, description, p_amended, t_amended, reason, 
  amender, src, chk) VALUES 
(4,'Afghanistan', 0, 0, 0, @SYSOP, 2001, 0),
(8,'Albania', 0, 0, 0, @SYSOP, 2001, 0),
(10,'Antarctica', 0, 0, 0, @SYSOP, 2001, 0),
(12,'Algeria', 0, 0, 0, @SYSOP, 2001, 0),
(16,'American Samoa', 0, 0, 0, @SYSOP, 2001, 0),
(20,'Andorra', 0, 0, 0, @SYSOP, 2001, 0),
(24,'Angola', 0, 0, 0, @SYSOP, 2001, 0),
(28,'Antigua and Barbuda', 0, 0, 0, @SYSOP, 2001, 0),
(31,'Azerbaijan', 0, 0, 0, @SYSOP, 2001, 0),
(32,'Argentina', 0, 0, 0, @SYSOP, 2001, 0),
(36,'Australia', 0, 0, 0, @SYSOP, 2001, 0),
(40,'Austria', 0, 0, 0, @SYSOP, 2001, 0),
(44,'Bahamas', 0, 0, 0, @SYSOP, 2001, 0),
(48,'Bahrain', 0, 0, 0, @SYSOP, 2001, 0),
(50,'Bangladesh', 0, 0, 0, @SYSOP, 2001, 0),
(51,'Armenia', 0, 0, 0, @SYSOP, 2001, 0),
(52,'Barbados', 0, 0, 0, @SYSOP, 2001, 0),
(56,'Belgium', 0, 0, 0, @SYSOP, 2001, 0),
(60,'Bermuda', 0, 0, 0, @SYSOP, 2001, 0),
(64,'Bhutan', 0, 0, 0, @SYSOP, 2001, 0),
(68,'Bolivia, Plurinational State of', 0, 0, 0, @SYSOP, 2001, 0),
(70,'Bosnia and Herzegovina', 0, 0, 0, @SYSOP, 2001, 0),
(72,'Botswana', 0, 0, 0, @SYSOP, 2001, 0),
(74,'Bouvet Island', 0, 0, 0, @SYSOP, 2001, 0),
(76,'Brazil', 0, 0, 0, @SYSOP, 2001, 0),
(84,'Belize', 0, 0, 0, @SYSOP, 2001, 0),
(86,'British Indian Ocean Territory', 0, 0, 0, @SYSOP, 2001, 0),
(90,'Solomon Islands', 0, 0, 0, @SYSOP, 2001, 0),
(92,'Virgin Islands, British', 0, 0, 0, @SYSOP, 2001, 0),
(96,'Brunei Darussalam', 0, 0, 0, @SYSOP, 2001, 0),
(100,'Bulgaria', 0, 0, 0, @SYSOP, 2001, 0),
(104,'Myanmar', 0, 0, 0, @SYSOP, 2001, 0),
(108,'Burundi', 0, 0, 0, @SYSOP, 2001, 0),
(112,'Belarus', 0, 0, 0, @SYSOP, 2001, 0),
(116,'Cambodia', 0, 0, 0, @SYSOP, 2001, 0),
(120,'Cameroon', 0, 0, 0, @SYSOP, 2001, 0),
(124,'Canada', 0, 0, 0, @SYSOP, 2001, 0),
(132,'Cape Verde', 0, 0, 0, @SYSOP, 2001, 0),
(136,'Cayman Islands', 0, 0, 0, @SYSOP, 2001, 0),
(140,'Central African Republic', 0, 0, 0, @SYSOP, 2001, 0),
(144,'Sri Lanka', 0, 0, 0, @SYSOP, 2001, 0),
(148,'Chad', 0, 0, 0, @SYSOP, 2001, 0),
(152,'Chile', 0, 0, 0, @SYSOP, 2001, 0),
(156,'China', 0, 0, 0, @SYSOP, 2001, 0),
(158,'Taiwan, Province of China', 0, 0, 0, @SYSOP, 2001, 0),
(162,'Christmas Island', 0, 0, 0, @SYSOP, 2001, 0),
(166,'Cocos (Keeling) Islands', 0, 0, 0, @SYSOP, 2001, 0),
(170,'Colombia', 0, 0, 0, @SYSOP, 2001, 0),
(174,'Comoros', 0, 0, 0, @SYSOP, 2001, 0),
(175,'Mayotte', 0, 0, 0, @SYSOP, 2001, 0),
(178,'Congo', 0, 0, 0, @SYSOP, 2001, 0),
(180,'Congo, the Democratic Republic of the', 0, 0, 0, @SYSOP, 2001, 0),
(184,'Cook Islands', 0, 0, 0, @SYSOP, 2001, 0),
(188,'Costa Rica', 0, 0, 0, @SYSOP, 2001, 0),
(191,'Croatia', 0, 0, 0, @SYSOP, 2001, 0),
(192,'Cuba', 0, 0, 0, @SYSOP, 2001, 0),
(196,'Cyprus', 0, 0, 0, @SYSOP, 2001, 0),
(203,'Czech Republic', 0, 0, 0, @SYSOP, 2001, 0),
(204,'Benin', 0, 0, 0, @SYSOP, 2001, 0),
(208,'Denmark', 0, 0, 0, @SYSOP, 2001, 0),
(212,'Dominica', 0, 0, 0, @SYSOP, 2001, 0),
(214,'Dominican Republic', 0, 0, 0, @SYSOP, 2001, 0),
(218,'Ecuador', 0, 0, 0, @SYSOP, 2001, 0),
(222,'El Salvador', 0, 0, 0, @SYSOP, 2001, 0),
(226,'Equatorial Guinea', 0, 0, 0, @SYSOP, 2001, 0),
(231,'Ethiopia', 0, 0, 0, @SYSOP, 2001, 0),
(232,'Eritrea', 0, 0, 0, @SYSOP, 2001, 0),
(233,'Estonia', 0, 0, 0, @SYSOP, 2001, 0),
(234,'Faroe Islands', 0, 0, 0, @SYSOP, 2001, 0),
(238,'Falkland Islands (Malvinas)', 0, 0, 0, @SYSOP, 2001, 0),
(239,'South Georgia and the South Sandwich Islands', 0, 0, 0, @SYSOP, 2001, 0),
(242,'Fiji', 0, 0, 0, @SYSOP, 2001, 0),
(246,'Finland', 0, 0, 0, @SYSOP, 2001, 0),
(248,'Åland Islands', 0, 0, 0, @SYSOP, 2001, 0),
(250,'France', 0, 0, 0, @SYSOP, 2001, 0),
(254,'French Guiana', 0, 0, 0, @SYSOP, 2001, 0),
(258,'French Polynesia', 0, 0, 0, @SYSOP, 2001, 0),
(260,'French Southern Territories', 0, 0, 0, @SYSOP, 2001, 0),
(262,'Djibouti', 0, 0, 0, @SYSOP, 2001, 0),
(266,'Gabon', 0, 0, 0, @SYSOP, 2001, 0),
(268,'Georgia', 0, 0, 0, @SYSOP, 2001, 0),
(270,'Gambia', 0, 0, 0, @SYSOP, 2001, 0);

-- - <Section 22> - 
INSERT INTO PLACES (place, description, p_amended, t_amended, reason, 
  amender, src, chk) VALUES
(275,'Palestine, State of', 0, 0, 0, @SYSOP, 2001, 0),
(276,'Germany', 0, 0, 0, @SYSOP, 2001, 0),
(288,'Ghana', 0, 0, 0, @SYSOP, 2001, 0),
(292,'Gibraltar', 0, 0, 0, @SYSOP, 2001, 0),
(296,'Kiribati', 0, 0, 0, @SYSOP, 2001, 0),
(300,'Greece', 0, 0, 0, @SYSOP, 2001, 0),
(304,'Greenland', 0, 0, 0, @SYSOP, 2001, 0),
(308,'Grenada', 0, 0, 0, @SYSOP, 2001, 0),
(312,'Guadeloupe', 0, 0, 0, @SYSOP, 2001, 0),
(316,'Guam', 0, 0, 0, @SYSOP, 2001, 0),
(320,'Guatemala', 0, 0, 0, @SYSOP, 2001, 0),
(324,'Guinea', 0, 0, 0, @SYSOP, 2001, 0),
(328,'Guyana', 0, 0, 0, @SYSOP, 2001, 0),
(332,'Haiti', 0, 0, 0, @SYSOP, 2001, 0),
(334,'Heard Island and McDonald Islands', 0, 0, 0, @SYSOP, 2001, 0),
(336,'Holy See (Vatican City State)', 0, 0, 0, @SYSOP, 2001, 0),
(340,'Honduras', 0, 0, 0, @SYSOP, 2001, 0),
(344,'Hong Kong', 0, 0, 0, @SYSOP, 2001, 0),
(348,'Hungary', 0, 0, 0, @SYSOP, 2001, 0),
(352,'Iceland', 0, 0, 0, @SYSOP, 2001, 0),
(356,'India', 0, 0, 0, @SYSOP, 2001, 0),
(360,'Indonesia', 0, 0, 0, @SYSOP, 2001, 0),
(364,'Iran, Islamic Republic of', 0, 0, 0, @SYSOP, 2001, 0),
(368,'Iraq', 0, 0, 0, @SYSOP, 2001, 0),
(372,'Ireland', 0, 0, 0, @SYSOP, 2001, 0),
(376,'Israel', 0, 0, 0, @SYSOP, 2001, 0),
(380,'Italy', 0, 0, 0, @SYSOP, 2001, 0),
(384,'Côte d''Ivoire', 0, 0, 0, @SYSOP, 2001, 0),
(388,'Jamaica', 0, 0, 0, @SYSOP, 2001, 0),
(392,'Japan', 0, 0, 0, @SYSOP, 2001, 0),
(398,'Kazakhstan', 0, 0, 0, @SYSOP, 2001, 0),
(400,'Jordan', 0, 0, 0, @SYSOP, 2001, 0),
(404,'Kenya', 0, 0, 0, @SYSOP, 2001, 0),
(408,'Korea, Democratic People''s Republic of', 0, 0, 0, @SYSOP, 2001, 0),
(410,'Korea, Republic of', 0, 0, 0, @SYSOP, 2001, 0),
(414,'Kuwait', 0, 0, 0, @SYSOP, 2001, 0),
(417,'Kyrgyzstan', 0, 0, 0, @SYSOP, 2001, 0),
(418,'Lao People''s Democratic Republic', 0, 0, 0, @SYSOP, 2001, 0),
(422,'Lebanon', 0, 0, 0, @SYSOP, 2001, 0),
(426,'Lesotho', 0, 0, 0, @SYSOP, 2001, 0),
(428,'Latvia', 0, 0, 0, @SYSOP, 2001, 0),
(430,'Liberia', 0, 0, 0, @SYSOP, 2001, 0),
(434,'Libya', 0, 0, 0, @SYSOP, 2001, 0),
(438,'Liechtenstein', 0, 0, 0, @SYSOP, 2001, 0),
(440,'Lithuania', 0, 0, 0, @SYSOP, 2001, 0),
(442,'Luxembourg', 0, 0, 0, @SYSOP, 2001, 0),
(446,'Macao', 0, 0, 0, @SYSOP, 2001, 0),
(450,'Madagascar', 0, 0, 0, @SYSOP, 2001, 0),
(454,'Malawi', 0, 0, 0, @SYSOP, 2001, 0),
(458,'Malaysia', 0, 0, 0, @SYSOP, 2001, 0),
(462,'Maldives', 0, 0, 0, @SYSOP, 2001, 0),
(466,'Mali', 0, 0, 0, @SYSOP, 2001, 0),
(470,'Malta', 0, 0, 0, @SYSOP, 2001, 0),
(474,'Martinique', 0, 0, 0, @SYSOP, 2001, 0),
(478,'Mauritania', 0, 0, 0, @SYSOP, 2001, 0),
(480,'Mauritius', 0, 0, 0, @SYSOP, 2001, 0),
(484,'Mexico', 0, 0, 0, @SYSOP, 2001, 0),
(492,'Monaco', 0, 0, 0, @SYSOP, 2001, 0),
(496,'Mongolia', 0, 0, 0, @SYSOP, 2001, 0),
(498,'Moldova, Republic of', 0, 0, 0, @SYSOP, 2001, 0),
(499,'Montenegro', 0, 0, 0, @SYSOP, 2001, 0),
(500,'Montserrat', 0, 0, 0, @SYSOP, 2001, 0),
(504,'Morocco', 0, 0, 0, @SYSOP, 2001, 0),
(508,'Mozambique', 0, 0, 0, @SYSOP, 2001, 0),
(512,'Oman', 0, 0, 0, @SYSOP, 2001, 0),
(516,'Namibia', 0, 0, 0, @SYSOP, 2001, 0),
(520,'Nauru', 0, 0, 0, @SYSOP, 2001, 0),
(524,'Nepal', 0, 0, 0, @SYSOP, 2001, 0),
(528,'Netherlands', 0, 0, 0, @SYSOP, 2001, 0);

-- - <Section 23> - 
INSERT INTO PLACES (place, description, p_amended, t_amended, reason, 
  amender, src, chk) VALUES
(531,'Curaçao', 0, 0, 0, @SYSOP, 2001, 0),
(533,'Aruba', 0, 0, 0, @SYSOP, 2001, 0),
(534,'Sint Maarten (Dutch part)', 0, 0, 0, @SYSOP, 2001, 0),
(535,'Bonaire, Sint Eustatius and Saba', 0, 0, 0, @SYSOP, 2001, 0),
(540,'New Caledonia', 0, 0, 0, @SYSOP, 2001, 0),
(548,'Vanuatu', 0, 0, 0, @SYSOP, 2001, 0),
(554,'New Zealand', 0, 0, 0, @SYSOP, 2001, 0),
(558,'Nicaragua', 0, 0, 0, @SYSOP, 2001, 0),
(562,'Niger', 0, 0, 0, @SYSOP, 2001, 0),
(566,'Nigeria', 0, 0, 0, @SYSOP, 2001, 0),
(570,'Niue', 0, 0, 0, @SYSOP, 2001, 0),
(574,'Norfolk Island', 0, 0, 0, @SYSOP, 2001, 0),
(578,'Norway', 0, 0, 0, @SYSOP, 2001, 0),
(580,'Northern Mariana Islands', 0, 0, 0, @SYSOP, 2001, 0),
(581,'United States Minor Outlying Islands', 0, 0, 0, @SYSOP, 2001, 0),
(583,'Micronesia, Federated States of', 0, 0, 0, @SYSOP, 2001, 0),
(584,'Marshall Islands', 0, 0, 0, @SYSOP, 2001, 0),
(585,'Palau', 0, 0, 0, @SYSOP, 2001, 0),
(586,'Pakistan', 0, 0, 0, @SYSOP, 2001, 0),
(591,'Panama', 0, 0, 0, @SYSOP, 2001, 0),
(598,'Papua New Guinea', 0, 0, 0, @SYSOP, 2001, 0),
(600,'Paraguay', 0, 0, 0, @SYSOP, 2001, 0),
(604,'Peru', 0, 0, 0, @SYSOP, 2001, 0),
(608,'Philippines', 0, 0, 0, @SYSOP, 2001, 0),
(612,'Pitcairn', 0, 0, 0, @SYSOP, 2001, 0),
(616,'Poland', 0, 0, 0, @SYSOP, 2001, 0),
(620,'Portugal', 0, 0, 0, @SYSOP, 2001, 0),
(624,'Guinea-Bissau', 0, 0, 0, @SYSOP, 2001, 0),
(626,'Timor-Leste', 0, 0, 0, @SYSOP, 2001, 0),
(630,'Puerto Rico', 0, 0, 0, @SYSOP, 2001, 0),
(634,'Qatar', 0, 0, 0, @SYSOP, 2001, 0),
(638,'Réunion', 0, 0, 0, @SYSOP, 2001, 0),
(642,'Romania', 0, 0, 0, @SYSOP, 2001, 0),
(643,'Russian Federation', 0, 0, 0, @SYSOP, 2001, 0),
(646,'Rwanda', 0, 0, 0, @SYSOP, 2001, 0),
(652,'Saint Barthélemy', 0, 0, 0, @SYSOP, 2001, 0),
(654,'Saint Helena, Ascension and Tristan da Cunha', 0, 0, 0, @SYSOP, 2001, 0),
(659,'Saint Kitts and Nevis', 0, 0, 0, @SYSOP, 2001, 0),
(660,'Anguilla', 0, 0, 0, @SYSOP, 2001, 0),
(662,'Saint Lucia', 0, 0, 0, @SYSOP, 2001, 0),
(663,'Saint Martin (French part)', 0, 0, 0, @SYSOP, 2001, 0),
(666,'Saint Pierre and Miquelon', 0, 0, 0, @SYSOP, 2001, 0),
(670,'Saint Vincent and the Grenadines', 0, 0, 0, @SYSOP, 2001, 0),
(674,'San Marino', 0, 0, 0, @SYSOP, 2001, 0),
(678,'Sao Tome and Principe', 0, 0, 0, @SYSOP, 2001, 0),
(682,'Saudi Arabia', 0, 0, 0, @SYSOP, 2001, 0),
(686,'Senegal', 0, 0, 0, @SYSOP, 2001, 0),
(688,'Serbia', 0, 0, 0, @SYSOP, 2001, 0),
(690,'Seychelles', 0, 0, 0, @SYSOP, 2001, 0),
(694,'Sierra Leone', 0, 0, 0, @SYSOP, 2001, 0),
(702,'Singapore', 0, 0, 0, @SYSOP, 2001, 0),
(703,'Slovakia', 0, 0, 0, @SYSOP, 2001, 0),
(704,'Viet Nam', 0, 0, 0, @SYSOP, 2001, 0),
(705,'Slovenia', 0, 0, 0, @SYSOP, 2001, 0),
(706,'Somalia', 0, 0, 0, @SYSOP, 2001, 0),
(710,'South Africa', 0, 0, 0, @SYSOP, 2001, 0),
(716,'Zimbabwe', 0, 0, 0, @SYSOP, 2001, 0),
(724,'Spain', 0, 0, 0, @SYSOP, 2001, 0),
(728,'South Sudan', 0, 0, 0, @SYSOP, 2001, 0),
(729,'Sudan', 0, 0, 0, @SYSOP, 2001, 0),
(732,'Western Sahara', 0, 0, 0, @SYSOP, 2001, 0),
(740,'Suriname', 0, 0, 0, @SYSOP, 2001, 0),
(744,'Svalbard and Jan Mayen', 0, 0, 0, @SYSOP, 2001, 0),
(748,'Swaziland', 0, 0, 0, @SYSOP, 2001, 0),
(752,'Sweden', 0, 0, 0, @SYSOP, 2001, 0),
(756,'Switzerland', 0, 0, 0, @SYSOP, 2001, 0),
(760,'Syrian Arab Republic', 0, 0, 0, @SYSOP, 2001, 0);

-- - <Section 24> - 
INSERT INTO PLACES (place, description, p_amended, t_amended, reason, 
  amender, src, chk) VALUES
(762,'Tajikistan', 0, 0, 0, @SYSOP, 2001, 0),
(764,'Thailand', 0, 0, 0, @SYSOP, 2001, 0),
(768,'Togo', 0, 0, 0, @SYSOP, 2001, 0),
(772,'Tokelau', 0, 0, 0, @SYSOP, 2001, 0),
(776,'Tonga', 0, 0, 0, @SYSOP, 2001, 0),
(780,'Trinidad and Tobago', 0, 0, 0, @SYSOP, 2001, 0),
(784,'United Arab Emirates', 0, 0, 0, @SYSOP, 2001, 0),
(788,'Tunisia', 0, 0, 0, @SYSOP, 2001, 0),
(792,'Turkey', 0, 0, 0, @SYSOP, 2001, 0),
(795,'Turkmenistan', 0, 0, 0, @SYSOP, 2001, 0),
(796,'Turks and Caicos Islands', 0, 0, 0, @SYSOP, 2001, 0),
(798,'Tuvalu', 0, 0, 0, @SYSOP, 2001, 0),
(800,'Uganda', 0, 0, 0, @SYSOP, 2001, 0),
(804,'Ukraine', 0, 0, 0, @SYSOP, 2001, 0),
(807,'Macedonia, the former Yugoslav Republic of', 0, 0, 0, @SYSOP, 2001, 0),
(818,'Egypt', 0, 0, 0, @SYSOP, 2001, 0),
(826,'United Kingdom', 0, 0, 0, @SYSOP, 2001, 0),
(831,'Guernsey', 0, 0, 0, @SYSOP, 2001, 0),
(832,'Jersey', 0, 0, 0, @SYSOP, 2001, 0),
(833,'Isle of Man', 0, 0, 0, @SYSOP, 2001, 0),
(834,'Tanzania, United Republic of', 0, 0, 0, @SYSOP, 2001, 0),
(840,'United States', 0, 0, 0, @SYSOP, 2001, 0),
(850,'Virgin Islands, U.S.', 0, 0, 0, @SYSOP, 2001, 0),
(854,'Burkina Faso', 0, 0, 0, @SYSOP, 2001, 0),
(858,'Uruguay', 0, 0, 0, @SYSOP, 2001, 0),
(860,'Uzbekistan', 0, 0, 0, @SYSOP, 2001, 0),
(862,'Venezuela, Bolivarian Republic of', 0, 0, 0, @SYSOP, 2001, 0),
(876,'Wallis and Futuna', 0, 0, 0, @SYSOP, 2001, 0),
(882,'Samoa', 0, 0, 0, @SYSOP, 2001, 0),
(887,'Yemen', 0, 0, 0, @SYSOP, 2001, 0),
(894,'Zambia', 0, 0, 0, @SYSOP, 2001, 0);

-- - <Section 25> - 
SELECT Now() `Starting`,"countrycodes" `Table`;

CREATE TABLE countrycodes
( country BIGINT
    ,constraint cc_country FOREIGN KEY (country)
      references PLACES(place)
    ,constraint cc_pk PRIMARY KEY (country)
  ,ccode varchar(2)
  ,tla varchar(3)
  ,ver integer default 0
  ,chk int default 0
)CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE countrycodes;

-- - <Section 26> - 
INSERT INTO countrycodes (ccode, tla, country)
VALUES
('XX', 'NUL', 0), -- generic null!
('UT', 'UTC', 1), -- for UTC ! 
('AF', 'AFG',4),   ('AX', 'ALA',248), ('AL', 'ALB',8),   ('DZ', 'DZA',12),  ('AS', 'ASM',16), 
('AD', 'AND',20),  ('AO', 'AGO',24),  ('AI', 'AIA',660), ('AQ', 'ATA',10),  ('AG', 'ATG',28), 
('AR', 'ARG',32),  ('AM', 'ARM',51),  ('AW', 'ABW',533), ('AU', 'AUS',36),  ('AT', 'AUT',40), 
('AZ', 'AZE',31),  ('BS', 'BHS',44),  ('BH', 'BHR',48),  ('BD', 'BGD',50),  ('BB', 'BRB',52), 
('BY', 'BLR',112), ('BE', 'BEL',56),  ('BZ', 'BLZ',84),  ('BJ', 'BEN',204), ('BM', 'BMU',60), 
('BT', 'BTN',64),  ('BO', 'BOL',68),  ('BQ', 'BES',535), ('BA', 'BIH',70),  ('BW', 'BWA',72), 
('BV', 'BVT',74),  ('BR', 'BRA',76),  ('IO', 'IOT',86),  ('BN', 'BRN',96),  ('BG', 'BGR',100), 
('BF', 'BFA',854),
('BI', 'BDI',108), ('KH', 'KHM',116), ('CM', 'CMR',120), ('CA', 'CAN',124), ('CV', 'CPV',132), 
('KY', 'CYM',136), ('CF', 'CAF',140), ('TD', 'TCD',148), ('CL', 'CHL',152), ('CN', 'CHN',156), 
('CX', 'CXR',162), ('CC', 'CCK',166), ('CO', 'COL',170), ('KM', 'COM',174), ('CG', 'COG',178), 
('CD', 'COD',180), ('CK', 'COK',184), ('CR', 'CRI',188), ('CI', 'CIV',384), ('HR', 'HRV',191), 
('CU', 'CUB',192), ('CW', 'CUW',531), ('CY', 'CYP',196), ('CZ', 'CZE',203), ('DK', 'DNK',208),
('DJ', 'DJI',262), ('DM', 'DMA',212), ('DO', 'DOM',214), ('EC', 'ECU',218), ('EG', 'EGY',818), 
('SV', 'SLV',222), ('GQ', 'GNQ',226), ('ER', 'ERI',232), ('EE', 'EST',233), ('ET', 'ETH',231), 
('FK', 'FLK',238), ('FO', 'FRO',234), ('FJ', 'FJI',242), ('FI', 'FIN',246), ('FR', 'FRA',250), 
('GF', 'GUF',254), ('PF', 'PYF',258), ('TF', 'ATF',260), ('GA', 'GAB',266), ('GM', 'GMB',270), 
('GE', 'GEO',268), ('DE', 'DEU',276), ('GH', 'GHA',288), ('GI', 'GIB',292), ('GR', 'GRC',300), 
('GL', 'GRL',304), ('GD', 'GRD',308), ('GP', 'GLP',312), ('GU', 'GUM',316), ('GT', 'GTM',320), 
('GG', 'GGY',831), ('GN', 'GIN',324), ('GW', 'GNB',624), ('GY', 'GUY',328), ('HT', 'HTI',332), 
('HM', 'HMD',334), ('VA', 'VAT',336), ('HN', 'HND',340), ('HK', 'HKG',344), ('HU', 'HUN',348), 
('IS', 'ISL',352), ('IN', 'IND',356), ('ID', 'IDN',360), ('IR', 'IRN',364), ('IQ', 'IRQ',368), 
('IE', 'IRL',372), ('IM', 'IMN',833), ('IL', 'ISR',376), ('IT', 'ITA',380), ('JM', 'JAM',388),
('JP', 'JPN',392), ('JE', 'JEY',832), ('JO', 'JOR',400), ('KZ', 'KAZ',398), ('KE', 'KEN',404), 
('KI', 'KIR',296), ('KP', 'PRK',408), ('KR', 'KOR',410), ('KW', 'KWT',414), ('KG', 'KGZ',417), 
('LA', 'LAO',418), ('LV', 'LVA',428), ('LB', 'LBN',422), ('LS', 'LSO',426), ('LR', 'LBR',430), 
('LY', 'LBY',434), ('LI', 'LIE',438), ('LT', 'LTU',440), ('LU', 'LUX',442), ('MO', 'MAC',446);

INSERT INTO countrycodes (ccode, tla, country)
VALUES
('MK', 'MKD',807), ('MG', 'MDG',450), ('MW', 'MWI',454), ('MY', 'MYS',458), ('MV', 'MDV',462), 
('ML', 'MLI',466), ('MT', 'MLT',470), ('MH', 'MHL',584), ('MQ', 'MTQ',474), ('MR', 'MRT',478), 
('MU', 'MUS',480), ('YT', 'MYT',175), ('MX', 'MEX',484), ('FM', 'FSM',583), ('MD', 'MDA',498), 
('MC', 'MCO',492), ('MN', 'MNG',496), ('ME', 'MNE',499), ('MS', 'MSR',500), ('MA', 'MAR',504), 
('MZ', 'MOZ',508), ('MM', 'MMR',104), ('NA', 'NAM',516), ('NR', 'NRU',520), ('NP', 'NPL',524), 
('NL', 'NLD',528), ('NC', 'NCL',540), ('NZ', 'NZL',554), ('NI', 'NIC',558), ('NE', 'NER',562), 
('NG', 'NGA',566), ('NU', 'NIU',570), ('NF', 'NFK',574), ('MP', 'MNP',580), ('NO', 'NOR',578), 
('OM', 'OMN',512), ('PK', 'PAK',586), ('PW', 'PLW',585), ('PS', 'PSE',275), ('PA', 'PAN',591), 
('PG', 'PNG',598), ('PY', 'PRY',600), ('PE', 'PER',604), ('PH', 'PHL',608), ('PN', 'PCN',612), 
('PL', 'POL',616), ('PT', 'PRT',620), ('PR', 'PRI',630), ('QA', 'QAT',634), ('RE', 'REU',638), 
('RO', 'ROU',642), ('RU', 'RUS',643), ('RW', 'RWA',646), ('BL', 'BLM',652), ('SH', 'SHN',654), 
('KN', 'KNA',659), ('LC', 'LCA',662), ('MF', 'MAF',663), ('PM', 'SPM',666), ('VC', 'VCT',670), 
('WS', 'WSM',882), ('SM', 'SMR',674), ('ST', 'STP',678), ('SA', 'SAU',682), ('SN', 'SEN',686), 
('RS', 'SRB',688), ('SC', 'SYC',690), ('SL', 'SLE',694), ('SG', 'SGP',702), ('SX', 'SXM',534), 
('SK', 'SVK',703), ('SI', 'SVN',705), ('SB', 'SLB',90), ('SO', 'SOM',706), ('ZA', 'ZAF',710), 
('GS', 'SGS',239), ('SS', 'SSD',728), ('ES', 'ESP',724), ('LK', 'LKA',144), ('SD', 'SDN',729), 
('SR', 'SUR',740), ('SJ', 'SJM',744), ('SZ', 'SWZ',748), ('SE', 'SWE',752), ('CH', 'CHE',756), 
('SY', 'SYR',760), ('TW', 'TWN',158), ('TJ', 'TJK',762), ('TZ', 'TZA',834), ('TH', 'THA',764), 
('TL', 'TLS',626), ('TG', 'TGO',768), ('TK', 'TKL',772), ('TO', 'TON',776), ('TT', 'TTO',780), 
('TN', 'TUN',788), ('TR', 'TUR',792), ('TM', 'TKM',795), ('TC', 'TCA',796), ('TV', 'TUV',798), 
('UG', 'UGA',800), ('UA', 'UKR',804), ('AE', 'ARE',784), ('GB', 'GBR',826), ('US', 'USA',840), 
('UM', 'UMI',581), ('UY', 'URY',858), ('UZ', 'UZB',860), ('VU', 'VUT',548), ('VE', 'VEN',862), 
('VN', 'VNM',704), ('VG', 'VGB',92), ('VI', 'VIR',850), ('WF', 'WLF',876), ('EH', 'ESH',732), 
('YE', 'YEM',887), ('ZM', 'ZMB',894), ('ZW', 'ZWE',716);

-- - <Section 27> - 
SELECT Now() `Starting`,"Institutions" `Table`;

CREATE TABLE Institutions
( institution integer
    ,constraint institution_pk PRIMARY KEY(institution)
  ,international_identifier varchar(64)
  ,name varchar(128)
  ,nature int default 0
  ,site BIGINT
  ,constraint bad_institution_site foreign key(site)
     references PLACES(place)
  ,t_amended BIGINT 
  ,reason int
  ,p_amended BIGINT 
  ,amender int 
  ,constraint bad_institution_amender foreign key(amender)
      references PEOPLE(person)
  ,srcID BIGINT
  ,src BIGINT
    ,constraint src_institution foreign key(src)
       references SOURCES(src)
  ,ver integer default 0
  ,chk int

  -- will likely need other fields here. 
)CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE Institutions;

-- - <Section 28> - 
INSERT INTO Institutions (institution, name, international_identifier,
                     site,
                     t_amended, reason, p_amended,
                     amender, src, chk)
  VALUES (0, 'unknown', '0', 
          0,
          0, 0, 0, 
          @SYSOP, 2001, 0);

-- - <Section 29> - 
ALTER TABLE SOURCES ADD CONSTRAINT bad_source_institution 
  foreign key(institution) references Institutions(institution);

-- - <Section 30> - 
SELECT Now() `Starting`,"timely" `Table`;

CREATE TABLE timely
( timekey integer 
    , constraint timely_pk PRIMARY KEY(timekey)
  ,region BIGINT
    ,constraint timely_region_fk FOREIGN KEY (region)
      references PLACES(place)
  , year integer
  , transition BIGINT
  , zone_offset BIGINT
  , dst BIGINT
  , ignored integer default 0
  , ver integer default 0
  , chk int
)CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE timely;

-- - <Section 31> - 
SELECT Now() `Starting`,"leapseconds" `Table`;

CREATE TABLE leapseconds
( leapsecond int 
    ,constraint leapkey PRIMARY KEY (leapsecond) 
  ,gpstime BIGINT
  ,utctime BIGINT
  ,toffset int -- baseline is -9
  ,ver integer default 0
  ,chk int
)CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE leapseconds;

-- - <Section 32> - 
CREATE TABLE PTABLES
( ptable integer AUTO_INCREMENT 
    ,constraint bad_ptable_pk primary key(ptable)
  ,tablename varchar(64)
  
  ,t_amended BIGINT
  ,reason int
  ,p_amended BIGINT
    ,constraint bad_ptable_amended_at foreign key(p_amended)
       references PLACES(place)
  ,amender integer 
    ,constraint bad_pillar_amender foreign key(amender)
      references PEOPLE(person)

  ,flags integer 

  ,ver integer default 0
  ,chk int
) CHARACTER SET=utf8mb4 
  COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE PTABLES;

-- - <Section 33> - 
-- SET @SYSOP = 2000;

INSERT INTO PTABLES
  ( tablename, t_amended, reason, p_amended, amender)
SELECT
   T.TABLE_NAME
   ,JD(CURRENT_TIMESTAMP)
   ,0
   ,0
   ,@SYSOP
FROM INFORMATION_SCHEMA.TABLES T WHERE T.TABLE_SCHEMA = 'smalltime'
  AND T.TABLE_NAME NOT IN ('SKEYS', 'USERS', 'PCOLUMNS', 'PTABLES', 'PERMITS') 
  AND T.TABLE_NAME NOT LIKE 'E\_%'; 

-- - <Section 34> - 
CREATE TABLE PCOLUMNS 
( pcolumn integer AUTO_INCREMENT 
    ,constraint bad_pcolumn_pk primary key(pcolumn)
  ,ptable integer 
    ,constraint bad_pcolumn_table foreign key(ptable)
       references PTABLES(ptable)
  ,colname varchar(64)
  ,canonical_position integer 
  ,column_type varchar(1) -- I J T F not varchar(64) 
  ,maximum_length integer 
  
  ,t_amended BIGINT
  ,reason int
  ,p_amended BIGINT
    ,constraint bad_pcolumn_amended_at foreign key(p_amended)
       references PLACES(place)
  ,amender integer 
    ,constraint bad_pcolumn_amender foreign key(amender)
      references PEOPLE(person)

  ,ver integer default 0
  ,chk int
) CHARACTER SET=utf8mb4 
  COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE PCOLUMNS;

-- - <Section 35> - 
-- SET @SYSOP = 2000;

INSERT INTO PCOLUMNS
  ( ptable, colname, canonical_position, column_type, maximum_length,
    t_amended, reason, p_amended, amender )
SELECT
  D.ptable
  ,C.COLUMN_NAME 
  ,C.ORDINAL_POSITION 
  ,CASE 
    WHEN C.COLUMN_TYPE LIKE 'varchar%' THEN 'T'
    WHEN C.COLUMN_TYPE LIKE 'bigint%' THEN 'I'
    WHEN C.COLUMN_TYPE LIKE 'int%' THEN 'J'
    WHEN C.COLUMN_TYPE LIKE 'float%' THEN 'F'
    ELSE 'Q'
  END 
  ,C.CHARACTER_MAXIMUM_LENGTH
  ,JD(CURRENT_TIMESTAMP)
  ,0
  ,0
  ,@SYSOP
FROM INFORMATION_SCHEMA.COLUMNS C
  INNER JOIN PTABLES D ON C.TABLE_NAME = D.tablename
WHERE C.TABLE_SCHEMA = 'smalltime'
  AND C.COLUMN_NAME NOT IN ( 'ver', 'chk' ) 
  AND D.tablename NOT IN ( 'skeys', 'usergroups', 'users' ); 


-- - <Section 36> - 
SELECT Now() `Starting`,"tz_rules" `Table`;

CREATE TABLE tz_rules
( tz_rule integer
  ,rule_name varchar(16)
  ,from_year varchar(8)
  ,to_year varchar(8)
  ,in_on_at varchar(64)
  ,dst varchar(8)
  ,is_active integer default 1
)CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE tz_rules;

-- - <Section 37> - 
SELECT Now() `Starting`,"tz_cutoffs" `Table`;

CREATE TABLE tz_cutoffs
( tz_cutoff integer
  ,stdoff varchar(16)
  ,rule_name varchar(16)
  ,region BIGINT
    ,constraint tz_cutoffs_region FOREIGN KEY (region)
      references PLACES(place)
  ,until_text varchar(16)
  ,is_active integer default 1
)CHARACTER SET=utf8mb4 
    COLLATE=utf8mb4_unicode_ci;SHOW WARNINGS;DESCRIBE tz_cutoffs;

-- - <Section 38> - 
INSERT INTO SKEYS (kName,        kValue, klock) VALUES 
                  ('tz_rules',   1000,   0),
                  ('tz_cutoffs', 1000,   0); 
-- -END OF FILE- 
